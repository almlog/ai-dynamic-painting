# AI動的絵画システム 完全セットアップガイド

> 「すごーい！AI動的絵画システムの完全セットアップなのだ〜！」  
> - 博士（はかせ）

---

## 🎯 このガイドについて

このガイドは、AI動的絵画システムをラズベリーパイで完全にセットアップするための詳細な手順書なのだ！初心者でも安心して進められるよう、段階的に説明しているのだなのだ〜！

**対象者**: Raspberry Pi初心者〜中級者  
**所要時間**: 約30-60分（ネットワーク環境による）  
**前提条件**: インターネット接続済みのRaspberry Pi

---

## 📋 目次

1. [ログイン直後の状況確認](#1-ログイン直後の状況確認)
2. [プロジェクト取得・セットアップ](#2-プロジェクト取得セットアップ)
3. [開発環境構築の完全手順](#3-開発環境構築の完全手順)
4. [動作確認方法](#4-動作確認方法)
5. [SuperClaude開始方法](#5-superclaude開始方法)
6. [トラブルシューティング](#6-トラブルシューティング)
7. [よくある質問](#7-よくある質問)

---

## 1. ログイン直後の状況確認

### 🔍 Step 1-1: 基本システム情報の確認

まずは現在のシステム状況を確認するのだ！

```bash
# OSとカーネル情報の確認
uname -a

# Python 環境の確認
python3 --version
which python3

# Git が利用可能か確認
git --version

# 現在のディレクトリと権限確認
pwd
whoami
ls -la ~

# ディスク容量の確認（重要なのだ！）
df -h
```

**期待される出力の例:**
```
Linux raspberrypi 6.12.34+rpt-rpi-v8 aarch64
Python 3.11.2
git version 2.39.5
/home/aipainting
aipainting
```

### 🔍 Step 1-2: ネットワーク接続確認

```bash
# インターネット接続の確認
ping -c 4 8.8.8.8

# GitHub への接続確認
ping -c 2 github.com

# DNS解決の確認
nslookup github.com
```

### 🔍 Step 1-3: 必要なシステムパッケージ確認

```bash
# 重要なパッケージの存在確認
which curl
which wget
which tar
which unzip

# パッケージマネージャーの更新
sudo apt update
```

---

## 2. プロジェクト取得・セットアップ

### 🚀 Step 2-1: プロジェクトディレクトリの確認

```bash
# ホームディレクトリに移動
cd ~

# 既存のプロジェクトディレクトリ確認
ls -la | grep ai-dynamic

# もしプロジェクトが存在しない場合はクローン
if [ ! -d "ai-dynamic-painting" ]; then
    echo "プロジェクトをクローンするのだ〜！"
    git clone https://github.com/almlog/ai-dynamic-painting.git
else
    echo "既存プロジェクトを発見したのだ！"
fi
```

### 🚀 Step 2-2: プロジェクトディレクトリへの移動

```bash
# プロジェクトディレクトリに移動
cd ~/ai-dynamic-painting

# 現在のブランチとコミット状況確認
git status
git log --oneline -n 5

# プロジェクト構造の確認
echo "=== プロジェクト構造 ==="
ls -la
```

**期待される構造:**
```
api/          # APIサーバー関連
core/         # コア機能
database/     # データベース関連  
deployment/   # デプロイ設定
docs/         # ドキュメント
m5stack/      # M5STACKプログラム
phase_status/ # フェーズ管理
scripts/      # ユーティリティスクリプト
tests/        # テストコード
web/          # Webフロントエンド
.claude/      # SuperClaude設定
.serena/      # Serena MCP設定
.venv/        # Python仮想環境
```

---

## 3. 開発環境構築の完全手順

### 🐍 Step 3-1: Python仮想環境の確認・作成

```bash
# 仮想環境の存在確認
if [ -d ".venv" ]; then
    echo "仮想環境が存在するのだ！"
else
    echo "仮想環境を作成するのだ〜！"
    python3 -m venv .venv
fi

# 仮想環境のアクティベート
source .venv/bin/activate

# アクティベート成功の確認
echo "現在のPython環境: $(which python)"
python --version
```

### 🐍 Step 3-2: 依存パッケージのインストール

```bash
# pipを最新版にアップグレード
pip install --upgrade pip

# 既にインストール済みパッケージの確認
echo "=== 現在インストール済みパッケージ ==="
pip list | head -20

# 必要な場合は requirements.txt があれば追加インストール
# pip install -r requirements.txt
```

**主要インストール済みパッケージ（確認用）:**
- `anthropic`: Claude API用
- `mcp`: MCPプロトコル用  
- `serena-agent`: Serena MCPエージェント
- `uvicorn`, `starlette`: FastAPI関連
- `flask`: Webフレームワーク
- `pandas`, `numpy`: データ分析用
- `matplotlib`: 可視化用

### 🐍 Step 3-3: 開発スクリプトの実行権限設定

```bash
# スクリプトディレクトリの確認
ls -la scripts/

# 開発用スクリプトに実行権限を付与
chmod +x scripts/start_dev.sh

# 実行権限の確認
ls -la scripts/start_dev.sh
```

---

## 4. 動作確認方法

### 🧪 Step 4-1: 開発環境起動スクリプトの実行

```bash
# 開発環境起動スクリプトを実行
./scripts/start_dev.sh
```

**期待される出力:**
```
🎨 AI動的絵画システム開発環境 🎨
「すごく楽しい開発が始まるのだ〜！」

Step 1: ディレクトリ確認なのだ
[SUCCESS] プロジェクトディレクトリを確認したのだ

Step 2: 仮想環境アクティベートなのだ  
[SUCCESS] 仮想環境をアクティベートしたのだ！

...（続く）...

🎉 開発環境起動完了なのだ〜！ 🎉
```

### 🧪 Step 4-2: Serena MCP設定の確認

```bash
# 仮想環境をアクティベート（必要に応じて）
source .venv/bin/activate

# Serenaコマンドの動作確認
serena --help

# プロジェクト設定の確認
cat .serena/project.yml | head -20

# Serenaプロジェクト状態確認
serena project status
```

### 🧪 Step 4-3: SuperClaude設定の確認

```bash
# SuperClaude設定ディレクトリの確認
ls -la .claude/

# 設定ファイルの存在確認
if [ -f ".claude/settings.local.json" ]; then
    echo "SuperClaude設定ファイル: ✅ 存在"
else
    echo "SuperClaude設定ファイル: ❌ 不在"
fi
```

---

## 5. SuperClaude開始方法

### 🤖 Step 5-1: Serena MCPサーバーの起動

```bash
# 新しいターミナルセッション（バックグラウンド起動の場合）
# または手動起動の場合：

# 仮想環境をアクティベート
source .venv/bin/activate

# Serena MCPサーバーを起動
serena start-mcp-server --project /home/aipainting/ai-dynamic-painting

# または自動起動スクリプトを使用：
./scripts/start_dev.sh
# 「Serena MCPサーバーを自動起動しますか？ [y/N]:」で「y」を入力
```

### 🤖 Step 5-2: SuperClaude（Claude Code）の起動

別のターミナルまたは外部から：

```bash
# Claude Code を起動（プロジェクトディレクトリから）
cd /home/aipainting/ai-dynamic-painting
claude

# または設定ファイルを指定して起動
claude --config .claude/settings.local.json
```

### 🤖 Step 5-3: SuperClaude動作確認

SuperClaude内で以下のコマンドを実行して動作確認：

```
# プロジェクト構造の確認
--serena プロジェクトの現在の状況を教えてください

# 博士ペルソナの確認  
--serena --think Phase1の進捗状況はいかがですか？

# タスク管理の確認
--task-manage 現在のタスク一覧を表示してください
```

---

## 6. トラブルシューティング

### 🚨 問題 6-1: 仮想環境のアクティベートができない

**症状:**
```bash
$ source .venv/bin/activate
bash: .venv/bin/activate: No such file or directory
```

**解決策:**
```bash
# 1. 仮想環境の再作成
rm -rf .venv
python3 -m venv .venv

# 2. アクティベートの再試行
source .venv/bin/activate

# 3. 必要パッケージの再インストール
pip install anthropic mcp serena-agent uvicorn starlette flask pandas numpy matplotlib
```

### 🚨 問題 6-2: Serenaコマンドが見つからない

**症状:**
```bash
$ serena --help
serena: command not found
```

**解決策:**
```bash
# 1. 仮想環境がアクティベートされているか確認
echo $VIRTUAL_ENV
# 出力: /home/aipainting/ai-dynamic-painting/.venv

# 2. アクティベートされていない場合
source .venv/bin/activate

# 3. serena-agentのインストール確認
pip list | grep serena

# 4. 必要に応じて再インストール
pip install serena-agent
```

### 🚨 問題 6-3: GitHubクローンができない

**症状:**
```bash
$ git clone https://github.com/almlog/ai-dynamic-painting.git
fatal: unable to access 'https://github.com/...': Could not resolve host: github.com
```

**解決策:**
```bash
# 1. ネットワーク接続確認
ping 8.8.8.8

# 2. DNS設定確認
cat /etc/resolv.conf

# 3. 必要に応じてDNSを設定
echo "nameserver 8.8.8.8" | sudo tee -a /etc/resolv.conf

# 4. 再試行
git clone https://github.com/almlog/ai-dynamic-painting.git
```

### 🚨 問題 6-4: SuperClaudeがSerenaに接続できない

**症状:**
- SuperClaudeは起動するが、`--serena`フラグが効かない
- MCPサーバー接続エラー

**解決策:**
```bash
# 1. Serena MCPサーバーの動作確認
ps aux | grep serena

# 2. サーバーが停止している場合は再起動  
source .venv/bin/activate
serena start-mcp-server --project /home/aipainting/ai-dynamic-painting &

# 3. ポート使用状況確認
netstat -tulpn | grep :8000

# 4. SuperClaude設定の確認・修正
nano .claude/settings.local.json
```

### 🚨 問題 6-5: 権限エラー

**症状:**
```bash
Permission denied
```

**解決策:**
```bash
# 1. ファイル権限確認
ls -la

# 2. オーナーシップの確認・修正
sudo chown -R aipainting:aipainting /home/aipainting/ai-dynamic-painting

# 3. 実行権限の付与
chmod +x scripts/*.sh

# 4. ディレクトリ権限の確認
find . -type d -exec chmod 755 {} \;
```

---

## 7. よくある質問

### ❓ Q1: 開発開始時に毎回実行する必要がある手順は？

**A1:** 毎回以下の手順を実行するのだ：

```bash
# 1. プロジェクトディレクトリに移動  
cd ~/ai-dynamic-painting

# 2. 仮想環境をアクティベート
source .venv/bin/activate

# 3. 開発環境起動（推奨）
./scripts/start_dev.sh
```

### ❓ Q2: SuperClaudeの博士ペルソナが正しく動作しない

**A2:** 以下を確認するのだ：

```bash
# 1. PERSONA.mdファイルの存在確認
ls -la PERSONA.md

# 2. Serena設定の確認
cat .serena/project.yml | grep -A 5 "persona"

# 3. SuperClaudeでの確認
# SuperClaude内で： --serena 博士ペルソナで挨拶してください
```

### ❓ Q3: Phase 1で何を実装すればよいの？

**A3:** Phase 1の実装範囲なのだ：

```yaml
# Phase 1 タスク一覧（.serena/project.yml から）
- 開発環境構築 ✅
- 基本APIサーバー実装 
- Web UI基本機能実装
- M5STACKプログラム作成
- Raspberry Pi設定
- 統合テスト  
- 24時間稼働テスト
```

### ❓ Q4: VEO APIキーの設定方法は？

**A4:** 環境変数で設定するのだ：

```bash
# 1. .envファイルを作成
nano .env

# 2. 以下の内容を追加：
VEO_API_KEY=your_actual_api_key_here
WEATHER_API_KEY=your_weather_api_key_here
DATABASE_URL=sqlite:///./app.db
DEBUG=true
LOG_LEVEL=INFO

# 3. .envファイルを読み込み（Pythonコードで自動読込）
```

### ❓ Q5: M5STACK関連の開発環境は？

**A5:** M5STACKにはPlatformIOを使用するのだ：

```bash
# PlatformIOのインストール（必要に応じて）
pip install platformio

# M5STACKプロジェクトの初期化（将来の実装時）  
cd m5stack/
pio project init --board m5stack-core-esp32

# コンパイル・アップロード（実装完了後）
pio run --target upload
```

---

## 🎉 セットアップ完了後の次のステップ

セットアップが完了したら、以下のコマンドでPhase1開発を開始するのだ！

```bash
# SuperClaude起動
claude

# SuperClaude内で博士との開発開始
--serena --think --task-manage Phase1の基本APIサーバー実装を開始しましょう！
```

---

## 📞 サポート・問い合わせ

問題が解決しない場合は、以下の情報を含めて相談するのだ：

```bash
# 環境情報の収集
echo "=== システム情報 ===" > debug_info.txt
uname -a >> debug_info.txt
python --version >> debug_info.txt  
echo "=== Python パッケージ ===" >> debug_info.txt
pip list >> debug_info.txt
echo "=== プロジェクト状態 ===" >> debug_info.txt
ls -la >> debug_info.txt
echo "=== エラーログ ===" >> debug_info.txt
# エラーメッセージをコピー&ペースト

# ファイルの内容確認
cat debug_info.txt
```

---

**「準備完了なのだ〜！素晴らしいAI動的絵画システムを作るのだなのだ！」**  
**「失敗を恐れず、楽しく実験していこうなのだ〜！」**

---

*最終更新: 2025年9月11日*  
*作成者: 博士（はかせ）with SuperClaude*