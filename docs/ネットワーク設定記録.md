# ネットワーク設定記録 - Raspberry Pi IP固定化

## 設定日時
**2025年9月11日** - Raspberry Pi IP固定化・ホスト名アクセス設定完了

## 🎯 固定化されたネットワーク設定

### WiFi接続設定 (wlan0)
- **固定IP**: `192.168.10.7/24`
- **ゲートウェイ**: `192.168.10.1`
- **DNS**: `192.168.10.1`
- **接続名**: `preconfigured`
- **インターフェース**: `wlan0` (WiFi)

### 有線接続設定 (eth0)
- **固定IP**: `192.168.10.8/24`
- **ゲートウェイ**: `192.168.10.1`
- **DNS**: `192.168.10.1`
- **接続名**: `Wired connection 1`
- **インターフェース**: `eth0` (Ethernet)

### ホスト名アクセス（mDNS）
- **ホスト名**: `ai-dynamic-painting`
- **mDNSアドレス**: `ai-dynamic-painting.local`
- **サービス**: Avahi (mDNS/DNS-SD)
- **状態**: Active (running)

### ネットワーク情報
- **ネットワーク範囲**: `192.168.10.0/24`
- **ブロードキャスト**: `192.168.10.255`
- **利用可能IP**: `192.168.10.1` ～ `192.168.10.254`

## 🔧 実行した設定コマンド

### WiFi静的IP設定 (wlan0)
```bash
# WiFi静的IP設定
sudo nmcli connection modify preconfigured \
  ipv4.method manual \
  ipv4.addresses 192.168.10.7/24 \
  ipv4.gateway 192.168.10.1 \
  ipv4.dns 192.168.10.1

# 接続再起動（設定反映）
sudo nmcli connection down preconfigured
sudo nmcli connection up preconfigured
```

### 有線静的IP設定 (eth0)
```bash
# 有線静的IP設定
sudo nmcli connection modify "Wired connection 1" \
  ipv4.method manual \
  ipv4.addresses 192.168.10.8/24 \
  ipv4.gateway 192.168.10.1 \
  ipv4.dns 192.168.10.1

# 有線接続時は自動的に192.168.10.8が適用される
```

### 設定前の状況
- **IP**: `192.168.10.7/24` (DHCP動的割当)
- **表示**: `inet 192.168.10.7/24 brd 192.168.10.255 scope global dynamic noprefixroute wlan0`

### 設定後の状況
- **IP**: `192.168.10.7/24` (静的固定)
- **表示**: `inet 192.168.10.7/24 brd 192.168.10.255 scope global noprefixroute wlan0`
- **変化**: `dynamic` 表示が消えて静的設定に変更

## ✅ 動作確認結果

### 1. ローカル接続確認
```bash
ping -c 3 192.168.10.1
# 結果: 3 packets transmitted, 3 received, 0% packet loss ✅
```

### 2. インターネット接続確認  
```bash
ping -c 3 8.8.8.8
# 結果: 3 packets transmitted, 3 received, 0% packet loss ✅
```

### 3. DNS解決確認
```bash
ping -c 3 google.com
# 結果: google.com (172.217.26.238) 正常解決・応答 ✅
```

## 🚀 AI動的絵画システムへの影響

### Phase 1開発への効果

#### 接続方法（3つの選択肢）
1. **ホスト名アクセス（推奨）** 🌟
   - Web UI: `http://ai-dynamic-painting.local:3000`
   - API: `http://ai-dynamic-painting.local:8000`
   - SSH: `ssh aipainting@ai-dynamic-painting.local`
   - **メリット**: IPアドレスを覚える必要なし、接続方法が変わっても同じ

2. **WiFi経由アクセス**
   - Web UI: `http://192.168.10.7:3000`
   - API: `http://192.168.10.7:8000`
   - SSH: `ssh aipainting@192.168.10.7`

3. **有線経由アクセス**
   - Web UI: `http://192.168.10.8:3000`
   - API: `http://192.168.10.8:8000`
   - SSH: `ssh aipainting@192.168.10.8`

### システム統合メリット
- **接続安定性**: IPアドレス変更によるシステム断絶回避
- **設定簡素化**: M5STACKファームウェアでハードコーディング可能
- **デバッグ効率**: 固定IPでSSH・HTTP接続が安定

## 🔍 今後の注意事項

### DHCPサーバー（ルーター）設定
- ルーター側で `192.168.10.7` をDHCP除外設定することを推奨
- 他デバイスとのIP競合防止

### 設定変更時の手順
```bash
# 設定確認
nmcli connection show preconfigured

# IP変更（必要な場合）
sudo nmcli connection modify preconfigured ipv4.addresses NEW_IP/24

# 接続再起動
sudo nmcli connection down preconfigured && sudo nmcli connection up preconfigured
```

### トラブルシューティング
```bash
# 接続状況確認
ip addr show wlan0
route -n
nmcli connection show

# DNS確認
cat /etc/resolv.conf

# 接続リセット（緊急時）
sudo nmcli connection modify preconfigured ipv4.method auto
sudo nmcli connection down preconfigured && sudo nmcli connection up preconfigured
```

## 📊 設定完了チェックリスト

### WiFi接続 (wlan0)
- [x] 静的IP設定完了 (`192.168.10.7/24`)
- [x] ゲートウェイ設定完了 (`192.168.10.1`)
- [x] DNS設定完了 (`192.168.10.1`)
- [x] 接続再起動・設定反映確認

### 有線接続 (eth0)
- [x] 静的IP設定完了 (`192.168.10.8/24`)
- [x] ゲートウェイ設定完了 (`192.168.10.1`)
- [x] DNS設定完了 (`192.168.10.1`)
- [x] 有線接続時に自動適用される設定

### ホスト名アクセス (mDNS)
- [x] ホスト名設定確認 (`ai-dynamic-painting`)
- [x] Avahiサービス稼働確認
- [x] mDNSアドレス有効 (`ai-dynamic-painting.local`)

### 動作確認
- [x] ローカルネットワーク接続確認
- [x] インターネット接続確認  
- [x] DNS解決確認
- [x] 設定記録ドキュメント作成

---

**🎉 Raspberry Pi ネットワーク設定完全完了！**

### 今後のアクセス方法（推奨順）

1. **🌟 ホスト名でアクセス（最も便利）**
   ```
   ssh aipainting@ai-dynamic-painting.local
   http://ai-dynamic-painting.local:8000
   ```

2. **📡 WiFi接続時**
   ```
   ssh aipainting@192.168.10.7
   http://192.168.10.7:8000
   ```

3. **🔌 有線接続時**
   ```
   ssh aipainting@192.168.10.8
   http://192.168.10.8:8000
   ```

**ホスト名 `ai-dynamic-painting.local` を使えば、接続方法を意識せずにアクセス可能なのだ〜✨**